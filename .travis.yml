# @TODO: Cache node dependencies
# @TODO: Make sure bundler cache really works
# @TODO: Fetch only UPDATED Contentful articles, not ALL of them
# @TODO: Rebuild only UPDATED pages, not ALL of them
# @TODO: Don't run specs on webhook hit (somehow)

language: ruby
rvm: 2.4.0

cache:
  bundler: true
  yarn: true
  directories:
    - node_modules

env:
  - DATA_DIR=sample

before_script:
  - nvm install 6
  - npm install -g yarn
  - yarn install
  - bundle exec rspec spec

script:
  - bundle exec middleman contentful
  - bundle exec middleman build
  - bundle exec middleman s3_sync
